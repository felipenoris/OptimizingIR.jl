<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>API Reference · OptimizingIR.jl</title><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.039/juliamono-regular.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">OptimizingIR.jl</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li class="is-active"><a class="tocitem" href>API Reference</a><ul class="internal"><li><a class="tocitem" href="#Public-API"><span>Public API</span></a></li><li><a class="tocitem" href="#Internals"><span>Internals</span></a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>API Reference</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>API Reference</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/felipenoris/OptimizingIR.jl/blob/master/docs/src/api.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="API-Reference"><a class="docs-heading-anchor" href="#API-Reference">API Reference</a><a id="API-Reference-1"></a><a class="docs-heading-anchor-permalink" href="#API-Reference" title="Permalink"></a></h1><h2 id="Public-API"><a class="docs-heading-anchor" href="#Public-API">Public API</a><a id="Public-API-1"></a><a class="docs-heading-anchor-permalink" href="#Public-API" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="OptimizingIR.Op" href="#OptimizingIR.Op"><code>OptimizingIR.Op</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">Op(f::Function;
        pure::Bool=false,
        commutative::Bool=false,
        hasleftidentity::Bool=false,
        hasrightidentity::Bool=false,
        identity_element::T=NULL_IDENTITY_ELEMENT,
        mutable_arg=nothing)</code></pre><p>Defines a basic instruction with optimization annotations.</p><p><strong>Arguments</strong></p><ul><li><p><code>f</code> is a Julia function to be executed by the <code>Op</code>.</p></li><li><p><code>pure</code>: marks the function as pure (<code>true</code>) or impure (<code>false</code>) .</p></li><li><p><code>commutative</code>: marks the <code>Op</code> as commutative.</p></li><li><p><code>hasleftidentity</code>: marks the <code>Op</code> as having an identity when operating from the left, which means that <code>f(I, v) = v</code>, where <code>I</code> is the <code>identity_element</code>.</p></li><li><p><code>hasrightidentity</code>: marks the <code>Op</code> as having an identity when operating from the right, which means that <code>f(v, I) = v</code>, where <code>I</code> is the <code>identity_element</code>.</p></li><li><p><code>mutable_arg</code>: either <code>nothing</code>, or the index or tuple of indexes of the arguments that need to be mutable.</p></li></ul><p><strong>Purity</strong></p><p>A function is considered <a href="https://en.wikipedia.org/wiki/Pure_function">pure</a> if its return value is the same for the same arguments, and has no side-effects.</p><p>Operations marked as <strong>pure</strong> are suitable for <a href="https://en.wikipedia.org/wiki/Value_numbering">Value-Numbering</a> optimization.</p><p>When marked as impure, all optimization passes are disabled.</p><p><strong>Examples</strong></p><pre><code class="language-julia hljs"># this Op allows using `+` as a pure, commutative function. Sets 0 as identity element.
const OP_SUM = OIR.Op(+, pure=true, commutative=true, hasleftidentity=true, hasrightidentity=true, identity_element=0)

# `-` as a pure function. Identity is zero but only `x - 0 = x` case is checked.
const OP_SUB = OIR.Op(-, pure=true, hasrightidentity=true, identity_element=0)

# `*` as pure commutative function. Sets 1 as identity element.
const OP_MUL = OIR.Op(*, pure=true, commutative=true, hasleftidentity=true, hasrightidentity=true, identity_element=1)

# `/` as a pure function. Identity is checked to the right: `a / 1 = a`.
const OP_DIV = OIR.Op(/, pure=true, hasrightidentity=true, identity_element=1)

# power function
const OP_POW = OIR.Op(^, pure=true, hasrightidentity=true, identity_element=1)

# an Op that uses an arbitrary Julia function
foreign_fun(a, b, c) = a^3 + b^2 + c
const OP_FOREIGN_FUN = OIR.Op(foreign_fun, pure=true)

# An Op that is impure: every time we run `zeros` a different Array is returned.
const OP_ZEROS = OIR.Op(zeros)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/felipenoris/OptimizingIR.jl/blob/654df4d405c8b917237e1184ab0b023ba71b2b34/src/types.jl#L120-L180">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="OptimizingIR.Variable" href="#OptimizingIR.Variable"><code>OptimizingIR.Variable</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">Variable{M&lt;:Mutability}</code></pre><p>Creates a variable identified by a symbol that can be either mutable or immutable.</p><p><strong>Alias</strong></p><p>For convenience, the following constants are defined in the package:</p><pre><code class="language-julia hljs">const MutableVariable = Variable{Mutable}
const ImmutableVariable = Variable{Immutable}</code></pre><p><strong>Examples</strong></p><pre><code class="language-julia hljs">m = OptimizingIR.MutableVariable(:varmut) # a mutable variable
im = OptimizingIR.ImmutableVariable(:varimut) # an immutable variable</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/felipenoris/OptimizingIR.jl/blob/654df4d405c8b917237e1184ab0b023ba71b2b34/src/types.jl#L58-L79">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="OptimizingIR.call" href="#OptimizingIR.call"><code>OptimizingIR.call</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">call(op, args...) :: LinearInstruction</code></pre><p>Creates an instruction as a call to operation <code>op</code> with arguments <code>args</code>.</p><p>Internally, it returns either a <a href="#OptimizingIR.PureInstruction"><code>OptimizingIR.PureInstruction</code></a> or an <a href="#OptimizingIR.ImpureInstruction"><code>OptimizingIR.ImpureInstruction</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/felipenoris/OptimizingIR.jl/blob/654df4d405c8b917237e1184ab0b023ba71b2b34/src/build.jl#L134-L142">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="OptimizingIR.addinstruction!" href="#OptimizingIR.addinstruction!"><code>OptimizingIR.addinstruction!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">addinstruction!(b::BasicBlock, instruction::LinearInstruction) :: ImmutableValue</code></pre><p>Pushes an instruction to a basic block. Returns the value that represents the result after the execution of the instruction.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/felipenoris/OptimizingIR.jl/blob/654df4d405c8b917237e1184ab0b023ba71b2b34/src/build.jl#L71-L77">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="OptimizingIR.addinput!" href="#OptimizingIR.addinput!"><code>OptimizingIR.addinput!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">addinput!(b::BasicBlock, iv::ImmutableVariable) :: Int</code></pre><p>Registers <code>iv</code> as an input variable of the function. Returns the index of this variable in the tuple of inputs (function arguments).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/felipenoris/OptimizingIR.jl/blob/654df4d405c8b917237e1184ab0b023ba71b2b34/src/build.jl#L90-L95">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="OptimizingIR.addoutput!" href="#OptimizingIR.addoutput!"><code>OptimizingIR.addoutput!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">addoutput!(b::BasicBlock, iv::Variable) :: Int</code></pre><p>Registers <code>iv</code> as an output variable of the function. Returns the index of this variable in the tuple of returned values.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/felipenoris/OptimizingIR.jl/blob/654df4d405c8b917237e1184ab0b023ba71b2b34/src/build.jl#L98-L103">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="OptimizingIR.assign!" href="#OptimizingIR.assign!"><code>OptimizingIR.assign!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">assign!(bb::BasicBlock, lhs::Variable, rhs::AbstractValue)</code></pre><p>Assigns the value <code>rhs</code> to variable <code>lhs</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/felipenoris/OptimizingIR.jl/blob/654df4d405c8b917237e1184ab0b023ba71b2b34/src/build.jl#L210-L214">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="OptimizingIR.constant" href="#OptimizingIR.constant"><code>OptimizingIR.constant</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">constant(val) :: Const</code></pre><p>Creates a constant value.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/felipenoris/OptimizingIR.jl/blob/654df4d405c8b917237e1184ab0b023ba71b2b34/src/build.jl#L15-L19">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="OptimizingIR.compile" href="#OptimizingIR.compile"><code>OptimizingIR.compile</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">compile(::Type{T}, program::Program) where {T&lt;:AbstractMachine}</code></pre><p>Compiles the IR to a Julia function. It returns a function or a callable object (functor).</p><pre><code class="language-julia hljs">const OIR = OptimizingIR
bb = OIR.BasicBlock()
# (...) add instructions to basic block
finterpreter = OIR.compile(OIR.BasicBlockInterpreter, bb)
fnative = OIR.compile(OIR.Native, bb)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/felipenoris/OptimizingIR.jl/blob/654df4d405c8b917237e1184ab0b023ba71b2b34/src/types.jl#L360-L373">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="OptimizingIR.has_symbol" href="#OptimizingIR.has_symbol"><code>OptimizingIR.has_symbol</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">has_symbol(bb::BasicBlock, sym::Symbol) :: Bool</code></pre><p>Returns <code>true</code> if there is any variable (input, local or output) defined that is identified by the symbol <code>sym</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/felipenoris/OptimizingIR.jl/blob/654df4d405c8b917237e1184ab0b023ba71b2b34/src/build.jl#L35-L40">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="OptimizingIR.generate_unique_variable_symbol" href="#OptimizingIR.generate_unique_variable_symbol"><code>OptimizingIR.generate_unique_variable_symbol</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">generate_unique_variable_symbol(bb::BasicBlock) :: Symbol</code></pre><p>OptimizingIR&#39;s version of <code>Base.gensym</code>.</p><p>Returns a new symbol for which <a href="#OptimizingIR.has_symbol"><code>OptimizingIR.has_symbol</code></a> is <code>false</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/felipenoris/OptimizingIR.jl/blob/654df4d405c8b917237e1184ab0b023ba71b2b34/src/build.jl#L53-L60">source</a></section></article><h2 id="Internals"><a class="docs-heading-anchor" href="#Internals">Internals</a><a id="Internals-1"></a><a class="docs-heading-anchor-permalink" href="#Internals" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="OptimizingIR.AbstractValue" href="#OptimizingIR.AbstractValue"><code>OptimizingIR.AbstractValue</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">AbstractValue{M&lt;:Mutability}</code></pre><p>A value can be marked as either Mutable or Immutable.</p><p>An immutable value can be assigned only once. A mutable value can be assigned more than once.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/felipenoris/OptimizingIR.jl/blob/654df4d405c8b917237e1184ab0b023ba71b2b34/src/types.jl#L10-L17">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="OptimizingIR.PureInstruction" href="#OptimizingIR.PureInstruction"><code>OptimizingIR.PureInstruction</code></a> — <span class="docstring-category">Type</span></header><section><div><p>A <code>PureInstruction</code> is a call to an operation that always returns the same value if the same arguments are passed to the instruction. It is suitable for memoization, in the sense that it can be optimized in the Value-Number algorithm inside a Basic Block.</p><p>An instruction is considered pure if its <code>call</code> has an pure <code>Op</code> and all of its arguments are immutable.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/felipenoris/OptimizingIR.jl/blob/654df4d405c8b917237e1184ab0b023ba71b2b34/src/types.jl#L208-L219">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="OptimizingIR.ImpureInstruction" href="#OptimizingIR.ImpureInstruction"><code>OptimizingIR.ImpureInstruction</code></a> — <span class="docstring-category">Type</span></header><section><div><p>An <code>ImpureInstruction</code> is a call to an operation that not always returns the same value if the same arguments are passed to the instruction. It is not suitable for memoization, and the Value-Number optimization must be disabled for this call.</p><p>An instruction is considered impure if its <code>call</code> has an impure <code>Op</code>, or if onde of its arguments is mutable.</p><p>Marking as mutable avoids Value-Numbering for this call.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/felipenoris/OptimizingIR.jl/blob/654df4d405c8b917237e1184ab0b023ba71b2b34/src/types.jl#L235-L248">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="OptimizingIR.SSAValue" href="#OptimizingIR.SSAValue"><code>OptimizingIR.SSAValue</code></a> — <span class="docstring-category">Type</span></header><section><div><p>A pointer to an instruction that computes a value.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/felipenoris/OptimizingIR.jl/blob/654df4d405c8b917237e1184ab0b023ba71b2b34/src/types.jl#L42-L45">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="OptimizingIR.try_on_add_instruction_passes" href="#OptimizingIR.try_on_add_instruction_passes"><code>OptimizingIR.try_on_add_instruction_passes</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">try_on_add_instruction_passes(program, instruction) :: Union{Nothing, ImmutableValue}</code></pre><p>Tries to apply all optimization passes available while running <code>addinstruction!</code>:</p><pre><code class="language-julia hljs">function addinstruction!(b::BasicBlock, instruction::LinearInstruction) :: ImmutableValue

    result = try_on_add_instruction_passes(b, instruction)
    if result !== nothing
        return result
    end

    # (...)
end</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/felipenoris/OptimizingIR.jl/blob/654df4d405c8b917237e1184ab0b023ba71b2b34/src/passes.jl#L207-L224">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="OptimizingIR.LookupTable" href="#OptimizingIR.LookupTable"><code>OptimizingIR.LookupTable</code></a> — <span class="docstring-category">Type</span></header><section><div><p>Generic struct for a lookup table that stores an ordered list of distinct elements.</p><ul><li><p><code>element</code> is stored in <code>entries</code> vector at index <code>i</code>.</p></li><li><p><code>index[element]</code> retrieves the index <code>i</code>.</p></li></ul><p>Use <code>addentry!</code> to add items to the table. It the table already has the item, <code>addentry!</code> will return the existing item&#39;s index.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/felipenoris/OptimizingIR.jl/blob/654df4d405c8b917237e1184ab0b023ba71b2b34/src/lookup_table.jl#L2-L13">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="OptimizingIR.Const" href="#OptimizingIR.Const"><code>OptimizingIR.Const</code></a> — <span class="docstring-category">Type</span></header><section><div><p>Constant value to be encoded directly into the IR. The address is the value itself.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/felipenoris/OptimizingIR.jl/blob/654df4d405c8b917237e1184ab0b023ba71b2b34/src/types.jl#L50-L53">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="OptimizingIR.OptimizationRule" href="#OptimizingIR.OptimizationRule"><code>OptimizingIR.OptimizationRule</code></a> — <span class="docstring-category">Type</span></header><section><div><p>Sets which optimizations are allowed to an <code>Op</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/felipenoris/OptimizingIR.jl/blob/654df4d405c8b917237e1184ab0b023ba71b2b34/src/types.jl#L87-L90">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="OptimizingIR.BasicBlockInterpreter" href="#OptimizingIR.BasicBlockInterpreter"><code>OptimizingIR.BasicBlockInterpreter</code></a> — <span class="docstring-category">Type</span></header><section><div><p>Used to compile to a function that is interpreted when executed.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/felipenoris/OptimizingIR.jl/blob/654df4d405c8b917237e1184ab0b023ba71b2b34/src/interpreter.jl#L18">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="OptimizingIR.Native" href="#OptimizingIR.Native"><code>OptimizingIR.Native</code></a> — <span class="docstring-category">Type</span></header><section><div><p>Used to compile to a function to machine code.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/felipenoris/OptimizingIR.jl/blob/654df4d405c8b917237e1184ab0b023ba71b2b34/src/native.jl#L2">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../">« Home</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.15 on <span class="colophon-date" title="Sunday 3 April 2022 14:07">Sunday 3 April 2022</span>. Using Julia version 1.7.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
